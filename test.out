wandb: Currently logged in as: sophie-spectacular (sophie-spectacular-massachusetts-institute-of-technology). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.20.1 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.13.5
wandb: Run data is saved locally in /Users/pipiskyblue/Downloads/jensen-lab/askcos_wln_pytorch/wandb/run-20250624_205055-zw4edbz9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run drawn-star-12
wandb: â­ï¸ View project at https://wandb.ai/sophie-spectacular-massachusetts-institute-of-technology/wln-torch-test
wandb: ðŸš€ View run at https://wandb.ai/sophie-spectacular-massachusetts-institute-of-technology/wln-torch-test/runs/zw4edbz9
Namespace(batch_size=10, clipnorm=5.0, cutoff=0.6, depth=3, early_stopping=2, epochs=10, hidden_bond_classifier=300, hidden_cand_ranker=500, learning_rate=0.001, model_dir='uspto_500k', model_name='uspto_500k', nproc=4, reagents=False, resume=3, test='data/test.txt.proc', train='data/train.txt.proc', valid='data/valid.txt.proc')

****************************************************************************************************
step 3 of 3: 0.00 seconds elapsed
****************************************************************************************************


****************************************************************************************************
Training of the candidate ranker: 0.00 seconds elapsed
****************************************************************************************************

Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])

warning! could not recover true smiles from gbonds: [Cl-:35].[OH:1][CH:2]([CH2:3][O:4][c:5]1[cH:6][cH:7][c:8]([C:9](=[O:10])[c:11]2[cH:12][cH:13][c:14]([N+:17](=[O:18])[O-:19])[cH:15][cH:16]2)[cH:20][cH:21]1)[CH2:22][n+:32]1[cH:31][cH:30][c:29](-[c:23]2[cH:24][cH:25][cH:26][cH:27][cH:28]2)[cH:34][cH:33]1
[ClH:35].[O:1]1[CH:2]([CH2:3][O:4][c:5]2[cH:6][cH:7][c:8]([C:9](=[O:10])[c:11]3[cH:12][cH:13][c:14]([N+:17](=[O:18])[O-:19])[cH:15][cH:16]3)[cH:20][cH:21]2)[CH2:22]1.[O:36]1[CH2:37][CH2:38][O:39][CH2:40][CH2:41]1.[OH2:42].[c:23]1(-[c:29]2[cH:30][cH:31][n:32][cH:33][cH:34]2)[cH:24][cH:25][cH:26][cH:27][cH:28]1    {(0, 21, 0.0), (21, 31, 1.0)}
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])

warning! could not recover true smiles from gbonds: [F:1][C:2]([c:3]1[cH:4][cH:5][c:6](-[c:9]2[cH:10][cH:11][n+:12]([O-:17])[cH:13][cH:14]2)[cH:7][cH:8]1)([F:15])[F:16]
[CH3:19][Re:20](=[O:21])(=[O:22])=[O:23].[Cl:24][CH2:25][Cl:26].[F:1][C:2]([c:3]1[cH:4][cH:5][c:6](-[c:9]2[cH:10][cH:11][n:12][cH:13][cH:14]2)[cH:7][cH:8]1)([F:15])[F:16].[OH:17][OH:18]    {(16, 17, 0.0), (11, 16, 1.0)}
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])

warning! could not recover true smiles from gbonds: [CH3:19][C:20]([CH3:21])([CH3:22])[c:23]1[cH:24][cH:25][c:26](-[c:29]2[cH:30][cH:31][c:32]3[c:33]([NH:46][C:47]([CH2:48][CH2:49][CH3:50])=[O:51])[n:34][nH:35][c:36]3[cH:37]2)[cH:27][cH:28]1
[CH3:19][C:20]([CH3:21])([CH3:22])[c:23]1[cH:24][cH:25][c:26](-[c:29]2[cH:30][cH:31][c:32]3[c:33]([NH:46][C:47]([CH2:48][CH2:49][CH3:50])=[O:51])[n:34][n:35]([CH2:38][O:39][CH2:40][CH2:41][Si:42]([CH3:43])([CH3:44])[CH3:45])[c:36]3[cH:37]2)[cH:27][cH:28]1.[CH3:2][CH2:3][CH2:4][CH2:5][N+:6]([CH2:7][CH2:8][CH2:9][CH3:10])([CH2:11][CH2:12][CH2:13][CH3:14])[CH2:15][CH2:16][CH2:17][CH3:18].[CH3:52][CH2:53][O:54][C:55](=[O:56])[CH3:57].[F-:1].[O:58]1[CH2:59][CH2:60][CH2:61][CH2:62]1    {(34, 37, 0.0)}
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
bond_graph_exp (viewed): torch.Size([76, 1510, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
atom_features (updated): torch.Size([76, 151, 500])

final_fp: torch.Size([76, 500])
reaction_fp: torch.Size([75, 500])
core_bias: torch.Size([1, 151])
scores pre-add: torch.Size([75])
Flattening inputs...
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_nei_idx: torch.Size([76, 151, 10, 2])
bond_nei_idx: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 2/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])

--- Layer 3/3 ---
atom_features_exp: torch.Size([76, 151, 10, 500])
atom_nei_idx_exp: torch.Size([76, 151, 10, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
input_bond_exp: torch.Size([76, 151, 10, 5])
bond_nei_idx_exp: torch.Size([76, 151, 10, 5])
fbond_nei: torch.Size([76, 151, 10, 5])
mask_nei: torch.Size([76, 151, 10, 1])
l_nei: torch.Size([76, 151, 10, 505])
pre_label: torch.Size([76, 151, 10, 500])
nei_label: torch.Size([76, 151, 500])
new_label: torch.Size([76, 151, 1000])
updated atom_features: torch.Size([76, 151, 500])
>> FORWARD PASS DEBUG <<
input_atom: torch.Size([76, 151, 89])
input_bond: torch.Size([76, 151, 5])
atom_graph: torch.Size([76, 151, 10, 2])
bond_graph: torch.Size([76, 151, 10, 2])
num_nbs: torch.Size([76, 151])
atom_features: torch.Size([76, 151, 500])

--- Layer 1/1 ---
atom_graph_idx: torch.Size([76, 151, 10])
atom_graph_exp (pre-view): torch.Size([76, 151, 10, 500])
atom_graph_exp (viewed): torch.Size([76, 1510, 500])
fatom_nei: torch.Size([76, 151, 10, 500])
bond_graph_exp (pre-view): torch.Size([76, 151, 10, 5])
wandb: ERROR Failed to sample metric: process no longer exists (pid=24880)
